import{j as N,a1 as C,X as S,F as A,am as M,av as H,au as B,v as D,y as F,T as L}from"./chunk-BVnoVvxf.js";import{C as I,B as T,d as E,g as R}from"./index-C7Uay0Nw.js";import"./chunk-iBnOZnHq.js";import"./chunk-DpwGd3gD.js";import"./chunk-CikwAM-J.js";import"./chunk-DNS1M2tN.js";import"./chunk-BicA77-G.js";const AnalysisHistoryModal=({isOpen:$,onClose:G,history:J,onRestoreAnalysis:K,onDeleteAnalysis:O})=>{if(!$)return null;const formatBytes=N=>{if(0===N)return"0 Bytes";const i=Math.floor(Math.log(N)/Math.log(1024));return parseFloat((N/Math.pow(1024,i)).toFixed(2))+" "+["Bytes","KB","MB","GB"][i]},formatDate=N=>{const C=new Date(N),S=(new Date).getTime()-C.getTime(),A=Math.floor(S/36e5),M=Math.floor(A/24);return A<1?"Just now":A<24?`${A}h ago`:M<7?`${M}d ago`:C.toLocaleDateString()},getSeverityColor=N=>{switch(N){case"Critical":return"text-red-600 bg-red-100 dark:bg-red-950/30";case"High":return"text-orange-600 bg-orange-100 dark:bg-orange-950/30";case"Medium":return"text-yellow-600 bg-yellow-100 dark:bg-yellow-950/30";case"Low":return"text-blue-600 bg-blue-100 dark:bg-blue-950/30";default:return"text-gray-600 bg-gray-100 dark:bg-gray-950/30"}},Q=[...J.currentAnalysis?[{...J.currentAnalysis,isCurrent:!0}]:[],...J.previousAnalyses.map(a=>({...a,isCurrent:!1}))].sort((a,b)=>b.timestamp-a.timestamp);return N.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:N.jsxs(I,{className:"w-full max-w-4xl max-h-[80vh] bg-white dark:bg-slate-800 shadow-2xl",children:[N.jsxs("div",{className:"flex items-center justify-between p-6 border-b dark:border-slate-700",children:[N.jsxs("div",{className:"flex items-center gap-3",children:[N.jsx(C,{className:"h-6 w-6 text-blue-600"}),N.jsxs("div",{children:[N.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white",children:"Analysis History"}),N.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[Q.length," analysis",1!==Q.length?"es":""," \u2022 ",formatBytes(J.totalStorageUsed)," used"]})]})]}),N.jsx(T,{variant:"ghost",size:"sm",onClick:G,className:"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300",children:N.jsx(S,{className:"h-5 w-5"})})]}),N.jsx("div",{className:"overflow-y-auto max-h-[60vh] p-6",children:0===Q.length?N.jsxs("div",{className:"text-center py-12 text-slate-500 dark:text-slate-400",children:[N.jsx(A,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),N.jsx("p",{className:"text-lg font-medium mb-2",children:"No Analysis History"}),N.jsx("p",{className:"text-sm",children:"Analyze some files to build your history."})]}):N.jsx("div",{className:"space-y-4",children:Q.map(C=>{const S=C.results.issues.filter(i=>"Critical"===i.severity).length,$=C.results.issues.filter(i=>"High"===i.severity).length,G=C.results.issues.length;return N.jsx(I,{className:"relative transition-all duration-200 hover:shadow-md "+(C.isCurrent?"ring-2 ring-blue-500 bg-blue-50/50 dark:bg-blue-950/20":""),children:N.jsx(E,{className:"p-4",children:N.jsxs("div",{className:"flex items-start justify-between",children:[N.jsxs("div",{className:"flex-1 min-w-0",children:[N.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[N.jsx(A,{className:"h-4 w-4 text-slate-600 dark:text-slate-400 flex-shrink-0"}),N.jsx("h3",{className:"font-medium text-slate-900 dark:text-white truncate",children:C.fileName}),C.isCurrent&&N.jsx(R,{variant:"outline",className:"text-blue-600 border-blue-600 ml-2",children:"Current"}),C.compressed&&N.jsx(R,{variant:"outline",className:"text-purple-600 border-purple-600",children:"Compressed"})]}),N.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-3",children:[N.jsxs("div",{children:[N.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Analyzed:"}),N.jsx("div",{className:"font-medium text-slate-900 dark:text-white",children:formatDate(C.timestamp)})]}),N.jsxs("div",{children:[N.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"File Size:"}),N.jsx("div",{className:"font-medium text-slate-900 dark:text-white",children:formatBytes(C.fileSize)})]}),N.jsxs("div",{children:[N.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Issues Found:"}),N.jsx("div",{className:"font-medium text-slate-900 dark:text-white",children:G})]}),N.jsxs("div",{children:[N.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Quality Score:"}),N.jsxs("div",{className:"flex items-center gap-1",children:[(J=C.results.summary.qualityScore,J>=80?N.jsx(D,{className:"h-4 w-4 text-green-600"}):J>=60?N.jsx(F,{className:"h-4 w-4 text-yellow-600"}):N.jsx(L,{className:"h-4 w-4 text-red-600"})),N.jsxs("span",{className:"font-medium text-slate-900 dark:text-white",children:[C.results.summary.qualityScore,"%"]})]})]})]}),N.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[S>0&&N.jsxs(R,{className:getSeverityColor("Critical"),children:[S," Critical"]}),$>0&&N.jsxs(R,{className:getSeverityColor("High"),children:[$," High"]}),0===G&&N.jsx(R,{className:getSeverityColor("Low"),children:"No Issues Found"})]}),N.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:N.jsxs("div",{className:"flex items-center gap-4",children:[N.jsxs("span",{children:["Engine: ",C.metadata.analysisEngine," v",C.metadata.engineVersion]}),N.jsxs("span",{children:["Session: ",C.metadata.sessionId.slice(-8)]}),N.jsxs("span",{className:"flex items-center gap-1",children:[N.jsx(M,{className:"h-3 w-3"}),new Date(C.timestamp).toLocaleString()]})]})})]}),N.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[!C.isCurrent&&N.jsxs(T,{variant:"outline",size:"sm",onClick:()=>K(C),className:"flex items-center gap-1 text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:hover:bg-blue-950/20",children:[N.jsx(H,{className:"h-3 w-3"}),"Restore"]}),O&&!C.isCurrent&&N.jsxs(T,{variant:"outline",size:"sm",onClick:()=>O(C.id),className:"flex items-center gap-1 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950/20",children:[N.jsx(B,{className:"h-3 w-3"}),"Delete"]})]})]})})},C.id);var J})})}),N.jsx("div",{className:"border-t dark:border-slate-700 p-4",children:N.jsxs("div",{className:"flex items-center justify-between text-sm text-slate-500 dark:text-slate-400",children:[N.jsxs("span",{children:["Showing ",Q.length," of ",J.maxHistorySize," maximum entries"]}),N.jsx(T,{variant:"outline",size:"sm",onClick:G,children:"Close"})]})})]})})};export{AnalysisHistoryModal,AnalysisHistoryModal as default};
